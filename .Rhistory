geom_point(aes(x=x4,y=3.1),color="black")+
geom_line(aes(y=ya,x=xplot), color="blue")+
ylim(c(0,13))
return(p1)
}
optim(x1,x2,x3,x4)
optim<-function(x1,x2,x3,x4){
a=672
b=-1.221
c=0.4956
chibest=1000
for(i in 1:50000){
chi1=sum((a*(x1^b)+c-2)^2/2)*5 #gives error of OD 2 measurement
chi2=sum((a*(x2^b)+c-1)^2/1) #gives error of OD 1 measurement
chi4=sum((a*(x3^b)+c-5.9)^2/5.9) #gives error of OD 1 measurement
chi5=sum((a*(x4^b)+c-3.1)^2/3.1) #gives error of OD 1 measurement
chi3=chi2+chi5
if(chi3<chibest){
chibest=chi3
abest=a
bbest=b
cbest=c
}
a=runif(1, 400, 1500)
b=-1*runif(1, 1.00, 1.60)
c=runif(1, 0.3000, 0.7000)
}
abest
bbest
cbest
print("Cost")
print(chi3)
print("Total Cost")
print(chi1+chi2+chi4+chi5)
xplot=seq(15,800,5)
yb=672*(xplot^(-1.221))+0.4956
ya=abest*(xplot^bbest)+cbest
plot(xplot,ya)
p1<-ggplot()+
ylab("OD")+
xlab("Intensity")+
geom_line(aes(y=yb,x=xplot), color="red")+
geom_point(aes(x=x1,y=2),color="black")+
geom_point(aes(x=x2,y=1),color="black")+
geom_point(aes(x=x3,y=5.9),color="black")+
geom_point(aes(x=x4,y=3.1),color="black")+
geom_line(aes(y=ya,x=xplot), color="blue")+
ylim(c(0,13))
return(p1)
}
optim(x1,x2,x3,x4)
optim<-function(x1,x2,x3,x4){
a=672
b=-1.221
c=0.4956
chibest=1000
for(i in 1:50000){
chi1=sum((a*(x1^b)+c-2)^2/2)*5 #gives error of OD 2 measurement
chi2=sum((a*(x2^b)+c-1)^2/1) #gives error of OD 1 measurement
chi4=sum((a*(x3^b)+c-5.9)^2/5.9) #gives error of OD 1 measurement
chi5=sum((a*(x4^b)+c-3.1)^2/3.1) #gives error of OD 1 measurement
chi3=chi1+chi2
if(chi3<chibest){
chibest=chi3
abest=a
bbest=b
cbest=c
}
a=runif(1, 400, 1500)
b=-1*runif(1, 1.00, 1.60)
c=runif(1, 0.3000, 0.7000)
}
abest
bbest
cbest
print("Cost")
print(chi3)
print("Total Cost")
print(chi1+chi2+chi4+chi5)
xplot=seq(15,800,5)
yb=672*(xplot^(-1.221))+0.4956
ya=abest*(xplot^bbest)+cbest
plot(xplot,ya)
p1<-ggplot()+
ylab("OD")+
xlab("Intensity")+
geom_line(aes(y=yb,x=xplot), color="red")+
geom_point(aes(x=x1,y=2),color="black")+
geom_point(aes(x=x2,y=1),color="black")+
geom_point(aes(x=x3,y=5.9),color="black")+
geom_point(aes(x=x4,y=3.1),color="black")+
geom_line(aes(y=ya,x=xplot), color="blue")+
ylim(c(0,13))
return(p1)
}
optim(x1,x2,x3,x4)
optim<-function(x1,x2,x3,x4){
a=672
b=-1.221
c=0.4956
chibest=1000
for(i in 1:50000){
chi1=sum((a*(x1^b)+c-2)^2/2)*5 #gives error of OD 2 measurement
chi2=sum((a*(x2^b)+c-1)^2/1) #gives error of OD 1 measurement
chi4=sum((a*(x3^b)+c-5.9)^2/5.9) #gives error of OD 1 measurement
chi5=sum((a*(x4^b)+c-3.1)^2/3.1) #gives error of OD 1 measurement
chi3=chi1+chi4
if(chi3<chibest){
chibest=chi3
abest=a
bbest=b
cbest=c
}
a=runif(1, 400, 1500)
b=-1*runif(1, 1.00, 1.60)
c=runif(1, 0.3000, 0.7000)
}
abest
bbest
cbest
print("Cost")
print(chi3)
print("Total Cost")
print(chi1+chi2+chi4+chi5)
xplot=seq(15,800,5)
yb=672*(xplot^(-1.221))+0.4956
ya=abest*(xplot^bbest)+cbest
plot(xplot,ya)
p1<-ggplot()+
ylab("OD")+
xlab("Intensity")+
geom_line(aes(y=yb,x=xplot), color="red")+
geom_point(aes(x=x1,y=2),color="black")+
geom_point(aes(x=x2,y=1),color="black")+
geom_point(aes(x=x3,y=5.9),color="black")+
geom_point(aes(x=x4,y=3.1),color="black")+
geom_line(aes(y=ya,x=xplot), color="blue")+
ylim(c(0,13))
return(p1)
}
optim(x1,x2,x3,x4)
optim<-function(x1,x2,x3,x4){
a=672
b=-1.221
c=0.4956
chibest=1000
for(i in 1:50000){
chi1=sum((a*(x1^b)+c-2)^2/2)*5 #gives error of OD 2 measurement
chi2=sum((a*(x2^b)+c-1)^2/1) #gives error of OD 1 measurement
chi4=sum((a*(x3^b)+c-5.9)^2/5.9) #gives error of OD 1 measurement
chi5=sum((a*(x4^b)+c-3.1)^2/3.1) #gives error of OD 1 measurement
chi3=chi1+chi5
if(chi3<chibest){
chibest=chi3
abest=a
bbest=b
cbest=c
}
a=runif(1, 400, 1500)
b=-1*runif(1, 1.00, 1.60)
c=runif(1, 0.3000, 0.7000)
}
abest
bbest
cbest
print("Cost")
print(chi3)
print("Total Cost")
print(chi1+chi2+chi4+chi5)
xplot=seq(15,800,5)
yb=672*(xplot^(-1.221))+0.4956
ya=abest*(xplot^bbest)+cbest
plot(xplot,ya)
p1<-ggplot()+
ylab("OD")+
xlab("Intensity")+
geom_line(aes(y=yb,x=xplot), color="red")+
geom_point(aes(x=x1,y=2),color="black")+
geom_point(aes(x=x2,y=1),color="black")+
geom_point(aes(x=x3,y=5.9),color="black")+
geom_point(aes(x=x4,y=3.1),color="black")+
geom_line(aes(y=ya,x=xplot), color="blue")+
ylim(c(0,13))
return(p1)
}
optim(x1,x2,x3,x4)
optim<-function(x1,x2,x3,x4){
a=672
b=-1.221
c=0.4956
chibest=1000
for(i in 1:50000){
chi1=sum((a*(x1^b)+c-2)^2/2)*5 #gives error of OD 2 measurement
chi2=sum((a*(x2^b)+c-1)^2/1) #gives error of OD 1 measurement
chi4=sum((a*(x3^b)+c-5.9)^2/5.9) #gives error of OD 1 measurement
chi5=sum((a*(x4^b)+c-3.1)^2/3.1) #gives error of OD 1 measurement
chi3=chi2+chi5
if(chi3<chibest){
chibest=chi3
abest=a
bbest=b
cbest=c
}
a=runif(1, 400, 1500)
b=-1*runif(1, 1.00, 1.60)
c=runif(1, 0.3000, 0.7000)
}
abest
bbest
cbest
print("Cost")
print(chi3)
print("Total Cost")
print(chi1+chi2+chi4+chi5)
xplot=seq(15,800,5)
yb=672*(xplot^(-1.221))+0.4956
ya=abest*(xplot^bbest)+cbest
plot(xplot,ya)
p1<-ggplot()+
ylab("OD")+
xlab("Intensity")+
geom_line(aes(y=yb,x=xplot), color="red")+
geom_point(aes(x=x1,y=2),color="black")+
geom_point(aes(x=x2,y=1),color="black")+
geom_point(aes(x=x3,y=5.9),color="black")+
geom_point(aes(x=x4,y=3.1),color="black")+
geom_line(aes(y=ya,x=xplot), color="blue")+
ylim(c(0,13))
return(p1)
}
optim(x1,x2,x3,x4)
optim<-function(x1,x2,x3,x4){
a=672
b=-1.221
c=0.4956
chibest=1000
for(i in 1:50000){
chi1=sum((a*(x1^b)+c-2)^2/2)*5 #gives error of OD 2 measurement
chi2=sum((a*(x2^b)+c-1)^2/1) #gives error of OD 1 measurement
chi4=sum((a*(x3^b)+c-5.9)^2/5.9) #gives error of OD 1 measurement
chi5=sum((a*(x4^b)+c-3.1)^2/3.1) #gives error of OD 1 measurement
chi3=chi2+chi4
if(chi3<chibest){
chibest=chi3
abest=a
bbest=b
cbest=c
}
a=runif(1, 400, 1500)
b=-1*runif(1, 1.00, 1.60)
c=runif(1, 0.3000, 0.7000)
}
abest
bbest
cbest
print("Cost")
print(chi3)
print("Total Cost")
print(chi1+chi2+chi4+chi5)
xplot=seq(15,800,5)
yb=672*(xplot^(-1.221))+0.4956
ya=abest*(xplot^bbest)+cbest
plot(xplot,ya)
p1<-ggplot()+
ylab("OD")+
xlab("Intensity")+
geom_line(aes(y=yb,x=xplot), color="red")+
geom_point(aes(x=x1,y=2),color="black")+
geom_point(aes(x=x2,y=1),color="black")+
geom_point(aes(x=x3,y=5.9),color="black")+
geom_point(aes(x=x4,y=3.1),color="black")+
geom_line(aes(y=ya,x=xplot), color="blue")+
ylim(c(0,13))
return(p1)
}
optim(x1,x2,x3,x4)
optim<-function(x1,x2,x3,x4){
a=672
b=-1.221
c=0.4956
chibest=1000
for(i in 1:50000){
chi1=sum((a*(x1^b)+c-2)^2/2)*5 #gives error of OD 2 measurement
chi2=sum((a*(x2^b)+c-1)^2/1) #gives error of OD 1 measurement
chi4=sum((a*(x3^b)+c-5.9)^2/5.9) #gives error of OD 1 measurement
chi5=sum((a*(x4^b)+c-3.1)^2/3.1) #gives error of OD 1 measurement
chi3=chi2+chi5
if(chi3<chibest){
chibest=chi3
abest=a
bbest=b
cbest=c
}
a=runif(1, 400, 1500)
b=-1*runif(1, 1.00, 1.60)
c=runif(1, 0.3000, 0.7000)
}
abest
bbest
cbest
print("Cost")
print(chi3)
print("Total Cost")
print(chi1+chi2+chi4+chi5)
xplot=seq(15,800,5)
yb=672*(xplot^(-1.221))+0.4956
ya=abest*(xplot^bbest)+cbest
plot(xplot,ya)
p1<-ggplot()+
ylab("OD")+
xlab("Intensity")+
geom_line(aes(y=yb,x=xplot), color="red")+
geom_point(aes(x=x1,y=2),color="black")+
geom_point(aes(x=x2,y=1),color="black")+
geom_point(aes(x=x3,y=5.9),color="black")+
geom_point(aes(x=x4,y=3.1),color="black")+
geom_line(aes(y=ya,x=xplot), color="blue")+
ylim(c(0,13))
return(p1)
}
optim(x1,x2,x3,x4)
x1=134
x2=360
x3=58
x4=86
optim(x1,x2,x3,x4)
x1=162
x2=386
x3=62
x4=90
optim(x1,x2,x3,x4)
optim<-function(x1,x2,x3,x4){
a=672
b=-1.221
c=0.4956
chibest=1000
for(i in 1:100000){
chi1=sum((a*(x1^b)+c-2)^2/2)*5 #gives error of OD 2 measurement
chi2=sum((a*(x2^b)+c-1)^2/1) #gives error of OD 1 measurement
chi4=sum((a*(x3^b)+c-5.9)^2/5.9) #gives error of OD 1 measurement
chi5=sum((a*(x4^b)+c-3.1)^2/3.1) #gives error of OD 1 measurement
chi3=chi2+chi5
if(chi3<chibest){
chibest=chi3
abest=a
bbest=b
cbest=c
}
a=runif(1, 400, 1500)
b=-1*runif(1, 1.00, 1.60)
c=runif(1, 0.3000, 0.7000)
}
abest
bbest
cbest
print("Cost")
print(chi3)
print("Total Cost")
print(chi1+chi2+chi4+chi5)
xplot=seq(15,800,5)
yb=672*(xplot^(-1.221))+0.4956
ya=abest*(xplot^bbest)+cbest
plot(xplot,ya)
p1<-ggplot()+
ylab("OD")+
xlab("Intensity")+
geom_line(aes(y=yb,x=xplot), color="red")+
geom_point(aes(x=x1,y=2),color="black")+
geom_point(aes(x=x2,y=1),color="black")+
geom_point(aes(x=x3,y=5.9),color="black")+
geom_point(aes(x=x4,y=3.1),color="black")+
geom_line(aes(y=ya,x=xplot), color="blue")+
ylim(c(0,13))
return(p1)
}
optim(x1,x2,x3,x4)
x1=134
x2=360
x3=58
x4=86
optim(x1,x2,x3,x4)
x1=162
x2=386
x3=62
x4=90
optim(x1,x2,x3,x4)
optim<-function(x1,x2,x3,x4){
a=672
b=-1.221
c=0.4956
chibest=1000
for(i in 1:100000){
chi1=sum((a*(x1^b)+c-2)^2/2) #gives error of OD 2 measurement
chi2=sum((a*(x2^b)+c-1)^2/1) #gives error of OD 1 measurement
chi4=sum((a*(x3^b)+c-5.9)^2/5.9) #gives error of OD 1 measurement
chi5=sum((a*(x4^b)+c-3.1)^2/3.1) #gives error of OD 1 measurement
chi3=chi2+chi5
if(chi3<chibest){
chibest=chi3
abest=a
bbest=b
cbest=c
}
a=runif(1, 400, 1500)
b=-1*runif(1, 1.00, 1.60)
c=runif(1, 0.3000, 0.7000)
}
abest
bbest
cbest
print("Cost")
print(chi3)
print("Total Cost")
print(chi1+chi2+chi4+chi5)
xplot=seq(15,800,5)
yb=672*(xplot^(-1.221))+0.4956
ya=abest*(xplot^bbest)+cbest
plot(xplot,ya)
p1<-ggplot()+
ylab("OD")+
xlab("Intensity")+
geom_line(aes(y=yb,x=xplot), color="red")+
geom_point(aes(x=x1,y=2),color="black")+
geom_point(aes(x=x2,y=1),color="black")+
geom_point(aes(x=x3,y=5.9),color="black")+
geom_point(aes(x=x4,y=3.1),color="black")+
geom_line(aes(y=ya,x=xplot), color="blue")+
ylim(c(0,13))
return(p1)
}
optim(x1,x2,x3,x4)
x1=134
x2=360
x3=58
x4=86
optim(x1,x2,x3,x4)
optim(x1,x2,x3,x4)
optim(x1,x2,x3,x4)
optim(x1,x2,x3,x4)
optim(x1,x2,x3,x4)
optim(x1,x2,x3,x4)
optim(x1,x2,x3,x4)
library(shiny); runApp('Model/app14.R')
shiny::runApp('Model/TrEx')
library(ggplot2)
install.packages("ggplot2")
runApp('Model/TrEx')
install.packages(
"ggplot2",
repos = c("http://rstudio.org/_packages",
"http://cran.rstudio.com")
)
library(ggplot2)
install.packages("colorspace")
library(ggplot2)
runApp('Model/TrEx')
install.packages("glue")
runApp('Model/TrEx')
install.packages("purrr")
install.packages("dplyr", dependencies=TRUE)
install.packages("DT", dependencies=TRUE)
install.packages("gdata", dependencies=TRUE)
install.packages("reshape", dependencies=TRUE)
install.packages("reshape2", dependencies=TRUE)
install.packages("MASS", dependencies=TRUE)
install.packages("gplots", dependencies=TRUE)
install.packages("scales", dependencies=TRUE)
install.packages("scales", dependencies = TRUE)
install.packages("GGally", dependencies = TRUE)
install.packages("network", dependencies = TRUE)
install.packages("ggpubr", dependencies = TRUE)
install.packages("cluster", dependencies = TRUE)
install.packages("factoextra", dependencies = TRUE)
install.packages("biomaRt", dependencies = TRUE)
BiocManager::install("biomaRt")
install.packages("shinyWidgets", dependencies = TRUE)
install.packages("IRanges", dependencies = TRUE)
install.packages("shinycssloaders", dependencies = TRUE)
install.packages("gtools", dependencies = TRUE)
install.packages("NbClust", dependencies = TRUE)
shiny::runApp('Model/TrEx')
runApp('Model/TrEx')
install.packages("openssl")
runApp('Model/TrEx')
options(repos = BiocInstaller::biocinstallRepos())
BiocManager::install()
getOption("repos")
options(repos=BiocManager::repositories())
getOption("repos")
runApp('Model/TrEx')
rsconnect::showLogs()
rsconnect::showLogs(TrEx)
runApp('Model/TrEx')
runApp('Model/TrEx')
dirtofile<-"C:/Users/davidju/Documents/Model/TrEx"
setwd(dirtofile)
runApp()
# setwd(paste(dirtofile,"/TF_data_files",sep=""))
#Load TSS start position
TSS.start<-read.csv(paste("~/TF_data_files/Resources/","190704_TSSData.tsv",sep=""), sep="\t", header=TRUE)
setwd("~/Model/TrEx")
setwd("~/Model/TrEx")
runApp()
# setwd(paste(dirtofile,"/TF_data_files",sep=""))
#Load TSS start position
TSS.start<-read.csv(paste("/TF_data_files/Resources/","190704_TSSData.tsv",sep=""), sep="\t", header=TRUE)
# setwd(paste(dirtofile,"/TF_data_files",sep=""))
#Load TSS start position
TSS.start<-read.csv(paste("TF_data_files/Resources/","190704_TSSData.tsv",sep=""), sep="\t", header=TRUE)
runApp()
runApp()
runApp()
